---
title: "Untitled"
author: "Arthur Sena"
date: "July 20, 2016"
output: html_document
---

```{r}

      ano.atual <- read.csv("~/Documentos/Didatica/ano-atual.csv")

     #Criando um ID para cada deputado
    deputados <- transform( ano.atual,id=as.numeric(factor(txNomeParlamentar)))
    
    #Criando uma tabela com o deputado e seu ID
    deputados_id <- select(deputados,txNomeParlamentar,id,sgPartido,sgUF) %>% group_by(txNomeParlamentar) %>% slice(c(1))

    #Salvando a tabela anterior
    write.table(deputados_id,file = "deputados_id.csv", sep = "," ,row.names = F)
    
    #Tabela se fazer o merge
    siconv_emenda <- read.csv("siconv_emenda.csv", sep=";")
    
    #Usando semi join do dplyr. Ele mantém apenas os deputados que conseguiu fazer o match
    colnames(deputados)[5] = "NOME_PARLAMENTAR"
    l <- deputados %>% semi_join(siconv_emenda) 
    length(unique(l$id)) #Ele fica com mais ou menos 386 deputados :/
    
    #Após isso eu tentei fazer de outra forma. Eu criei um script em python pra atribuir o ID do deputado na mão (make_id.py). 
    #No fim, eu obtive o dataset abaixo que se encontra compactado
    
    siconv_emendaID <- read.csv("~/Documentos/Didatica/siconv_emendaID.csv")
    length(unique(siconv_emendaID$id)) # Ele conseguiu atribuir 532 ID's. Lembrando que o total é 572. 
    
    View(filter(siconv_emendaID, id == 27))
    View(filter(siconv_emendaID, id == 547))
    View(filter(siconv_emendaID, id == 177))
    View(filter(siconv_emendaID, id == 211))
    View(filter(siconv_emendaID, id == 543))
    
    #Filtrando os deputados válidos e salvando. Removendo os deputados que ele não conseguiu colocar o ID
    deputados_validos <- (filter(deputados, id %in% siconv_emendaID$id))
      
    #Salvando em CSV o Merge dos dados.
    write.table(deputados_validos, file = "ano.atual_deputados_id.csv", sep = ",", row.names = F)
    
```


